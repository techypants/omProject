<svg viewBox="0 0 1200 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font: bold 28px sans-serif; fill: #1f2937; }
      .subtitle { font: bold 20px sans-serif; fill: #374151; }
      .heading { font: bold 16px sans-serif; fill: #1f2937; }
      .text { font: 13px sans-serif; fill: #4b5563; }
      .small-text { font: 11px sans-serif; fill: #6b7280; }
      .box-blue { fill: #dbeafe; stroke: #3b82f6; stroke-width: 2; }
      .box-green { fill: #d1fae5; stroke: #10b981; stroke-width: 2; }
      .box-red { fill: #fee2e2; stroke: #ef4444; stroke-width: 2; }
      .box-yellow { fill: #fef3c7; stroke: #f59e0b; stroke-width: 2; }
      .arrow-blue { fill: none; stroke: #3b82f6; stroke-width: 2; }
      .arrow-green { fill: none; stroke: #10b981; stroke-width: 2; }
    </style>
    
    <marker id="arrow-b" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#3b82f6" />
    </marker>
    <marker id="arrow-g" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#10b981" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="600" y="40" class="title" text-anchor="middle">Diagram 5: Timer and Answer Checking</text>
  <line x1="100" y1="50" x2="1100" y2="50" stroke="#e5e7eb" stroke-width="2"/>

  <!-- LEFT SIDE: TIMER FLOW -->
  <rect x="50" y="80" width="500" height="480" rx="10" fill="#eff6ff" stroke="#3b82f6" stroke-width="3"/>
  <text x="300" y="110" class="subtitle" text-anchor="middle" fill="#1e40af">TIMER SYSTEM</text>

  <!-- Game Starts -->
  <rect x="200" y="140" width="200" height="45" rx="5" class="box-blue"/>
  <text x="300" y="167" class="text" text-anchor="middle" font-weight="bold">Game Starts</text>

  <line x1="300" y1="185" x2="300" y2="210" class="arrow-blue" marker-end="url(#arrow-b)"/>

  <!-- setInterval -->
  <rect x="175" y="210" width="250" height="60" rx="5" fill="#93c5fd" stroke="#1e40af" stroke-width="2"/>
  <text x="300" y="233" class="heading" text-anchor="middle">setInterval()</text>
  <text x="300" y="253" class="text" text-anchor="middle">Runs every 1 second</text>

  <line x1="300" y1="270" x2="300" y2="295" class="arrow-blue" marker-end="url(#arrow-b)"/>

  <!-- Decrease time -->
  <rect x="175" y="295" width="250" height="45" rx="5" class="box-blue"/>
  <text x="300" y="323" class="text" text-anchor="middle">timeLeft = timeLeft - 1</text>

  <line x1="300" y1="340" x2="300" y2="365" class="arrow-blue" marker-end="url(#arrow-b)"/>

  <!-- Decision diamond -->
  <path d="M 300 365 L 370 405 L 300 445 L 230 405 Z" class="box-yellow"/>
  <text x="300" y="405" class="text" text-anchor="middle" font-weight="bold">Time Up?</text>
  <text x="300" y="420" class="small-text" text-anchor="middle">(timeLeft = 0?)</text>

  <!-- Yes path -->
  <line x1="370" y1="405" x2="450" y2="405" class="arrow-blue" marker-end="url(#arrow-b)"/>
  <text x="390" y="395" class="small-text" font-weight="bold">YES</text>
  
  <rect x="450" y="380" width="70" height="50" rx="5" class="box-red"/>
  <text x="485" y="400" class="small-text" text-anchor="middle">Submit</text>
  <text x="485" y="415" class="small-text" text-anchor="middle">(Timeout)</text>

  <!-- No path (loop back) -->
  <line x1="230" y1="405" x2="150" y2="405" class="arrow-blue"/>
  <line x1="150" y1="405" x2="150" y2="318" class="arrow-blue"/>
  <line x1="150" y1="318" x2="175" y2="318" class="arrow-blue" marker-end="url(#arrow-b)"/>
  <text x="140" y="395" class="small-text" font-weight="bold">NO</text>
  <text x="130" y="360" class="small-text" fill="#3b82f6">Loop</text>

  <!-- RIGHT SIDE: ANSWER CHECKING FLOW -->
  <rect x="650" y="80" width="500" height="480" rx="10" fill="#f0fdf4" stroke="#10b981" stroke-width="3"/>
  <text x="900" y="110" class="subtitle" text-anchor="middle" fill="#065f46">ANSWER CHECKING</text>

  <!-- User submits -->
  <rect x="775" y="140" width="250" height="45" rx="5" class="box-green"/>
  <text x="900" y="167" class="text" text-anchor="middle" font-weight="bold">User Submits Answer</text>

  <line x1="900" y1="185" x2="900" y2="210" class="arrow-green" marker-end="url(#arrow-g)"/>

  <!-- Get current question -->
  <rect x="750" y="210" width="300" height="60" rx="5" class="box-green"/>
  <text x="900" y="233" class="heading" text-anchor="middle">Get Current Question</text>
  <text x="900" y="253" class="text" text-anchor="middle">currentQ = questions[currentIndex]</text>

  <line x1="900" y1="270" x2="900" y2="295" class="arrow-green" marker-end="url(#arrow-g)"/>

  <!-- Compare -->
  <rect x="775" y="295" width="250" height="45" rx="5" fill="#86efac" stroke="#10b981" stroke-width="2"/>
  <text x="900" y="323" class="text" text-anchor="middle">userAnswer === currentQ.answer?</text>

  <line x1="900" y1="340" x2="900" y2="365" class="arrow-green" marker-end="url(#arrow-g)"/>

  <!-- Decision diamond -->
  <path d="M 900 365 L 970 405 L 900 445 L 830 405 Z" class="box-yellow"/>
  <text x="900" y="408" class="text" text-anchor="middle" font-weight="bold">Correct?</text>

  <!-- Correct path -->
  <line x1="970" y1="405" x2="1050" y2="405" class="arrow-green" marker-end="url(#arrow-g)"/>
  <text x="990" y="395" class="small-text" font-weight="bold" fill="#10b981">YES ✓</text>
  
  <rect x="1050" y="380" width="70" height="50" rx="5" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
  <text x="1085" y="400" class="small-text" text-anchor="middle">Mark</text>
  <text x="1085" y="415" class="small-text" text-anchor="middle">Correct</text>

  <!-- Wrong path -->
  <line x1="830" y1="405" x2="750" y2="405" class="arrow-green" marker-end="url(#arrow-g)"/>
  <text x="805" y="395" class="small-text" font-weight="bold" fill="#ef4444">NO ✗</text>
  
  <rect x="680" y="380" width="70" height="50" rx="5" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="715" y="400" class="small-text" text-anchor="middle">Mark</text>
  <text x="715" y="415" class="small-text" text-anchor="middle">Wrong</text>

  <!-- Both converge -->
  <line x1="1085" y1="430" x2="1085" y2="460" class="arrow-green"/>
  <line x1="1085" y1="460" x2="900" y2="460" class="arrow-green"/>
  
  <line x1="715" y1="430" x2="715" y2="460" class="arrow-green"/>
  <line x1="715" y1="460" x2="900" y2="460" class="arrow-green" marker-end="url(#arrow-g)"/>

  <!-- Next question -->
  <rect x="775" y="470" width="250" height="50" rx="5" fill="#86efac" stroke="#059669" stroke-width="2"/>
  <text x="900" y="493" class="heading" text-anchor="middle">currentIndex++</text>
  <text x="900" y="510" class="text" text-anchor="middle">Move to next question</text>

  <!-- Bottom note -->
  <rect x="50" y="570" width="1100" height="25" rx="5" fill="#f3f4f6" stroke="#d1d5db" stroke-width="1"/>
  <text x="600" y="588" class="text" text-anchor="middle" font-style="italic">
    These two systems run in parallel during Challenge Mode!
  </text>
</svg>